var x,d,W,P,F,H,E={},O=[],Y=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function k(t,e1){for(var n in e1)t[n]=e1[n];return t}function R(t){var e2=t.parentNode;e2&&e2.removeChild(t)}function Z(t,e3,n){var o,l1,_,s1={};for(_ in e3)_=="key"?o=e3[_]:_=="ref"?l1=e3[_]:s1[_]=e3[_];if(arguments.length>2&&(s1.children=arguments.length>3?x.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(_ in t.defaultProps)s1[_]===void 0&&(s1[_]=t.defaultProps[_]);return S(t,s1,o,l1,null)}function S(t,e4,n,o,l2){var _={type:t,props:e4,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:l2??++W};return l2==null&&d.vnode!=null&&d.vnode(_),_}function U(t){return t.children}function D(t,e5){this.props=t,this.context=e5}function C(t,e6){if(e6==null)return t.__?C(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e6<t.__k.length;e6++)if((n=t.__k[e6])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?C(t):null}function B(t){var e7,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e7=0;e7<t.__k.length;e7++)if((n=t.__k[e7])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return B(t)}}function L(t){(!t.__d&&(t.__d=!0)&&P.push(t)&&!T.__r++||H!==d.debounceRendering)&&((H=d.debounceRendering)||F)(T)}function T(){for(var t;T.__r=P.length;)t=P.sort((function(e8,n){return e8.__v.__b-n.__v.__b})),P=[],t.some((function(e9){var n,o,l3,_,s2,u1;e9.__d&&(s2=(_=(n=e9).__v).__e,(u1=n.__P)&&(o=[],(l3=k({},_)).__v=_.__v+1,M(u1,_,l3,n.__n,u1.ownerSVGElement!==void 0,_.__h!=null?[s2]:null,o,s2??C(_),_.__h),J(o,_),_.__e!=s2&&B(_)))}))}function $(t,e10,n,o,l4,_,s3,u2,p1,a1){var r,h1,c1,i1,f,b1,v2,y1=o&&o.__k||O,m1=y1.length;for(n.__k=[],r=0;r<e10.length;r++)if((i1=n.__k[r]=(i1=e10[r])==null||typeof i1=="boolean"?null:typeof i1=="string"||typeof i1=="number"||typeof i1=="bigint"?S(null,i1,null,null,i1):Array.isArray(i1)?S(U,{children:i1},null,null,null):i1.__b>0?S(i1.type,i1.props,i1.key,null,i1.__v):i1)!=null){if(i1.__=n,i1.__b=n.__b+1,(c1=y1[r])===null||c1&&i1.key==c1.key&&i1.type===c1.type)y1[r]=void 0;else for(h1=0;h1<m1;h1++){if((c1=y1[h1])&&i1.key==c1.key&&i1.type===c1.type){y1[h1]=void 0;break}c1=null}M(t,i1,c1=c1||E,l4,_,s3,u2,p1,a1),f=i1.__e,(h1=i1.ref)&&c1.ref!=h1&&(v2||(v2=[]),c1.ref&&v2.push(c1.ref,null,i1),v2.push(h1,i1.__c||f,i1)),f!=null?(b1==null&&(b1=f),typeof i1.type=="function"&&i1.__k===c1.__k?i1.__d=p1=V(i1,p1,t):p1=j(t,i1,c1,y1,f,p1),typeof n.type=="function"&&(n.__d=p1)):p1&&c1.__e==p1&&p1.parentNode!=t&&(p1=C(c1))}for(n.__e=b1,r=m1;r--;)y1[r]!=null&&(typeof n.type=="function"&&y1[r].__e!=null&&y1[r].__e==n.__d&&(n.__d=C(o,r+1)),Q(y1[r],y1[r]));if(v2)for(r=0;r<v2.length;r++)K(v2[r],v2[++r],v2[++r])}function V(t,e11,n){for(var o,l5=t.__k,_=0;l5&&_<l5.length;_++)(o=l5[_])&&(o.__=t,e11=typeof o.type=="function"?V(o,e11,n):j(n,o,o,l5,o.__e,e11));return e11}function j(t,e12,n,o,l6,_){var s4,u3,p2;if(e12.__d!==void 0)s4=e12.__d,e12.__d=void 0;else if(n==null||l6!=_||l6.parentNode==null)e:if(_==null||_.parentNode!==t)t.appendChild(l6),s4=null;else{for(u3=_,p2=0;(u3=u3.nextSibling)&&p2<o.length;p2+=2)if(u3==l6)break e;t.insertBefore(l6,_),s4=_}return s4!==void 0?s4:l6.nextSibling}function te(t,e13,n,o,l7){var _;for(_ in n)_==="children"||_==="key"||_ in e13||N(t,_,null,n[_],o);for(_ in e13)l7&&typeof e13[_]!="function"||_==="children"||_==="key"||_==="value"||_==="checked"||n[_]===e13[_]||N(t,_,e13[_],n[_],o)}function z(t,e14,n){e14[0]==="-"?t.setProperty(e14,n):t[e14]=n==null?"":typeof n!="number"||Y.test(e14)?n:n+"px"}function N(t,e15,n,o,l8){var _;e:if(e15==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof o=="string"&&(t.style.cssText=o=""),o)for(e15 in o)n&&e15 in n||z(t.style,e15,"");if(n)for(e15 in n)o&&n[e15]===o[e15]||z(t.style,e15,n[e15])}else if(e15[0]==="o"&&e15[1]==="n")_=e15!==(e15=e15.replace(/Capture$/,"")),e15=e15.toLowerCase()in t?e15.toLowerCase().slice(2):e15.slice(2),t.l||(t.l={}),t.l[e15+_]=n,n?o||t.addEventListener(e15,_?q:G,_):t.removeEventListener(e15,_?q:G,_);else if(e15!=="dangerouslySetInnerHTML"){if(l8)e15=e15.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if(e15!=="href"&&e15!=="list"&&e15!=="form"&&e15!=="tabIndex"&&e15!=="download"&&e15 in t)try{t[e15]=n??"";break e}catch{}typeof n=="function"||(n!=null&&(n!==!1||e15[0]==="a"&&e15[1]==="r")?t.setAttribute(e15,n):t.removeAttribute(e15))}}function G(t){this.l[t.type+!1](d.event?d.event(t):t)}function q(t){this.l[t.type+!0](d.event?d.event(t):t)}function M(t,e16,n,o,l9,_,s5,u4,p3){var a2,r,h2,c2,i2,f,b2,v3,y2,m2,w,g1=e16.type;if(e16.constructor!==void 0)return null;n.__h!=null&&(p3=n.__h,u4=e16.__e=n.__e,e16.__h=null,_=[u4]),(a2=d.__b)&&a2(e16);try{e:if(typeof g1=="function"){if(v3=e16.props,y2=(a2=g1.contextType)&&o[a2.__c],m2=a2?y2?y2.props.value:a2.__:o,n.__c?b2=(r=e16.__c=n.__c).__=r.__E:("prototype"in g1&&g1.prototype.render?e16.__c=r=new g1(v3,m2):(e16.__c=r=new D(v3,m2),r.constructor=g1,r.render=_e),y2&&y2.sub(r),r.props=v3,r.state||(r.state={}),r.context=m2,r.__n=o,h2=r.__d=!0,r.__h=[]),r.__s==null&&(r.__s=r.state),g1.getDerivedStateFromProps!=null&&(r.__s==r.state&&(r.__s=k({},r.__s)),k(r.__s,g1.getDerivedStateFromProps(v3,r.__s))),c2=r.props,i2=r.state,h2)g1.getDerivedStateFromProps==null&&r.componentWillMount!=null&&r.componentWillMount(),r.componentDidMount!=null&&r.__h.push(r.componentDidMount);else{if(g1.getDerivedStateFromProps==null&&v3!==c2&&r.componentWillReceiveProps!=null&&r.componentWillReceiveProps(v3,m2),!r.__e&&r.shouldComponentUpdate!=null&&r.shouldComponentUpdate(v3,r.__s,m2)===!1||e16.__v===n.__v){r.props=v3,r.state=r.__s,e16.__v!==n.__v&&(r.__d=!1),r.__v=e16,e16.__e=n.__e,e16.__k=n.__k,e16.__k.forEach((function(A1){A1&&(A1.__=e16)})),r.__h.length&&s5.push(r);break e}r.componentWillUpdate!=null&&r.componentWillUpdate(v3,r.__s,m2),r.componentDidUpdate!=null&&r.__h.push((function(){r.componentDidUpdate(c2,i2,f)}))}r.context=m2,r.props=v3,r.state=r.__s,(a2=d.__r)&&a2(e16),r.__d=!1,r.__v=e16,r.__P=t,a2=r.render(r.props,r.state,r.context),r.state=r.__s,r.getChildContext!=null&&(o=k(k({},o),r.getChildContext())),h2||r.getSnapshotBeforeUpdate==null||(f=r.getSnapshotBeforeUpdate(c2,i2)),w=a2!=null&&a2.type===U&&a2.key==null?a2.props.children:a2,$(t,Array.isArray(w)?w:[w],e16,n,o,l9,_,s5,u4,p3),r.base=e16.__e,e16.__h=null,r.__h.length&&s5.push(r),b2&&(r.__E=r.__=null),r.__e=!1}else _==null&&e16.__v===n.__v?(e16.__k=n.__k,e16.__e=n.__e):e16.__e=ne(n.__e,e16,n,o,l9,_,s5,p3);(a2=d.diffed)&&a2(e16)}catch(A2){e16.__v=null,(p3||_!=null)&&(e16.__e=u4,e16.__h=!!p3,_[_.indexOf(u4)]=null),d.__e(A2,e16,n)}}function J(t,e17){d.__c&&d.__c(e17,t),t.some((function(n){try{t=n.__h,n.__h=[],t.some((function(o){o.call(n)}))}catch(o){d.__e(o,n.__v)}}))}function ne(t,e18,n,o,l10,_,s6,u5){var p4,a3,r,h3=n.props,c3=e18.props,i3=e18.type,f=0;if(i3==="svg"&&(l10=!0),_!=null){for(;f<_.length;f++)if((p4=_[f])&&"setAttribute"in p4==!!i3&&(i3?p4.localName===i3:p4.nodeType===3)){t=p4,_[f]=null;break}}if(t==null){if(i3===null)return document.createTextNode(c3);t=l10?document.createElementNS("http://www.w3.org/2000/svg",i3):document.createElement(i3,c3.is&&c3),_=null,u5=!1}if(i3===null)h3===c3||u5&&t.data===c3||(t.data=c3);else{if(_=_&&x.call(t.childNodes),a3=(h3=n.props||E).dangerouslySetInnerHTML,r=c3.dangerouslySetInnerHTML,!u5){if(_!=null)for(h3={},f=0;f<t.attributes.length;f++)h3[t.attributes[f].name]=t.attributes[f].value;(r||a3)&&(r&&(a3&&r.__html==a3.__html||r.__html===t.innerHTML)||(t.innerHTML=r&&r.__html||""))}if(te(t,c3,h3,l10,u5),r)e18.__k=[];else if(f=e18.props.children,$(t,Array.isArray(f)?f:[f],e18,n,o,l10&&i3!=="foreignObject",_,s6,_?_[0]:n.__k&&C(n,0),u5),_!=null)for(f=_.length;f--;)_[f]!=null&&R(_[f]);u5||("value"in c3&&(f=c3.value)!==void 0&&(f!==h3.value||f!==t.value||i3==="progress"&&!f)&&N(t,"value",f,h3.value,!1),"checked"in c3&&(f=c3.checked)!==void 0&&f!==t.checked&&N(t,"checked",f,h3.checked,!1))}return t}function K(t,e19,n){try{typeof t=="function"?t(e19):t.current=e19}catch(o){d.__e(o,n)}}function Q(t,e20,n){var o,l11;if(d.unmount&&d.unmount(t),(o=t.ref)&&(o.current&&o.current!==t.__e||K(o,null,e20)),(o=t.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(_){d.__e(_,e20)}o.base=o.__P=null}if(o=t.__k)for(l11=0;l11<o.length;l11++)o[l11]&&Q(o[l11],e20,typeof t.type!="function");n||t.__e==null||R(t.__e),t.__e=t.__d=void 0}function _e(t,e,n){return this.constructor(t,n)}function re(t,e21,n){var o,l12,_;d.__&&d.__(t,e21),l12=(o=typeof n=="function")?null:n&&n.__k||e21.__k,_=[],M(e21,t=(!o&&n||e21).__k=Z(U,null,[t]),l12||E,E,e21.ownerSVGElement!==void 0,!o&&n?[n]:l12?null:e21.firstChild?x.call(e21.childNodes):null,_,!o&&n?n:l12?l12.__e:e21.firstChild,o),J(_,t)}x=O.slice,d={__e:function(t,e22){for(var n,o,l13;e22=e22.__;)if((n=e22.__c)&&!n.__)try{if((o=n.constructor)&&o.getDerivedStateFromError!=null&&(n.setState(o.getDerivedStateFromError(t)),l13=n.__d),n.componentDidCatch!=null&&(n.componentDidCatch(t),l13=n.__d),l13)return n.__E=n}catch(_){t=_}throw t}},W=0,D.prototype.setState=function(t,e23){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=k({},this.state),typeof t=="function"&&(t=t(k({},n),this.props)),t&&k(n,t),t!=null&&this.__v&&(e23&&this.__h.push(e23),L(this))},D.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),L(this))},D.prototype.render=U,P=[],F=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,T.__r=0,0;var u=0;function v(n,s7,l14,a4,f){var r,o,_={};for(o in s7)o=="ref"?r=s7[o]:_[o]=s7[o];var e24={type:n,props:_,key:l14,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--u,__source:a4,__self:f};if(typeof n=="function"&&(r=n.defaultProps))for(o in r)_[o]===void 0&&(_[o]=r[o]);return d.vnode&&d.vnode(e24),e24}var c,e,l,i=0,h=[],p=d.__b,H1=d.__r,d1=d.diffed,b=d.__c,y=d.unmount;function a(_,n){d.__h&&d.__h(e,_,i||n),i=0;var t=e.__H||(e.__H={__:[],__h:[]});return _>=t.__.length&&t.__.push({}),t.__[_]}function F1(_){return i=1,q1(A,_)}function q1(_,n,t){var u6=a(c++,2);return u6.t=_,u6.__c||(u6.__=[t?t(n):A(void 0,n),function(o){var f=u6.t(u6.__[0],o);u6.__[0]!==f&&(u6.__=[f,u6.__[1]],u6.__c.setState({}))}],u6.__c=e),u6.__}function T1(_,n){var t=a(c++,3);!d.__s&&m(t.__H,n)&&(t.__=_,t.__H=n,e.__H.__h.push(t))}function x1(){var _;for(h.sort((function(n,t){return n.__v.__b-t.__v.__b}));_=h.pop();)if(_.__P)try{_.__H.__h.forEach(s),_.__H.__h.forEach(v1),_.__H.__h=[]}catch(n){_.__H.__h=[],d.__e(n,_.__v)}}d.__b=function(_){e=null,p&&p(_)},d.__r=function(_){H1&&H1(_),c=0;var n=(e=_.__c).__H;n&&(n.__h.forEach(s),n.__h.forEach(v1),n.__h=[])},d.diffed=function(_){d1&&d1(_);var n=_.__c;n&&n.__H&&n.__H.__h.length&&(h.push(n)!==1&&l===d.requestAnimationFrame||((l=d.requestAnimationFrame)||function(t){var u7,o=function(){clearTimeout(f),g&&cancelAnimationFrame(u7),setTimeout(t)},f=setTimeout(o,100);g&&(u7=requestAnimationFrame(o))})(x1)),e=null},d.__c=function(_,n){n.some((function(t){try{t.__h.forEach(s),t.__h=t.__h.filter((function(u8){return!u8.__||v1(u8)}))}catch(u9){n.some((function(o){o.__h&&(o.__h=[])})),n=[],d.__e(u9,t.__v)}})),b&&b(_,n)},d.unmount=function(_){y&&y(_);var n,t=_.__c;t&&t.__H&&(t.__H.__.forEach((function(u10){try{s(u10)}catch(o){n=o}})),n&&d.__e(n,t.__v))};var g=typeof requestAnimationFrame=="function";function s(_){var n=e,t=_.__c;typeof t=="function"&&(_.__c=void 0,t()),e=n}function v1(_){var n=e;_.__c=_.__(),e=n}function m(_,n){return!_||_.length!==n.length||n.some((function(t,u){return t!==_[u]}))}function A(_,n){return typeof n=="function"?n(_):n}const importMeta={url:"file:///home/sheep/uxdy/webreg-scraping/scrape.ts",main:false};class AuthorizedGetter{#term;#sessionIndex;#uqz;#cache;constructor(term1,sessionIndex,uqz,cache=false){this.#term=term1;this.#sessionIndex=sessionIndex;this.#uqz=uqz;this.#cache=cache}async get(path,query){const fileName=query.subjcode?.length>0?`${path}_${query.subjcode.trim()}_${query.crsecode.trim()}`:path;if(this.#cache){const json=await Deno.readTextFile(`./webreg-data/${fileName}.json`).then(JSON.parse).catch((error=>error instanceof Deno.errors.NotFound?null:Promise.reject(error)));if(json!==null){return json}}const json=fetch(`https://act.ucsd.edu/webreg2/svc/wradapter/secure/${path}?${new URLSearchParams(query)}`,{headers:{Cookie:`jlinksessionidx=${this.#sessionIndex}; UqZBpD3n=${this.#uqz}`}}).then((response=>response.ok?response.json():Promise.reject(`HTTP ${response.status} error from ${response.url}`)));if(this.#cache){await Deno.writeTextFile(`./webreg-data/${fileName}.json`,JSON.stringify(json,null,"\t")+"\n")}return json}subjects(){return this.get("search-load-subject",{termcode:this.#term})}departments(){return this.get("search-load-department",{termcode:this.#term})}courses({subjcode:subjcode="",crsecode:crsecode="",department:department="",professor:professor="",title:title="",levels:levels="",days:days="",timestr:timestr="",opensection:opensection=false,isbasic:isbasic=true,basicsearchvalue:basicsearchvalue=""}={}){return this.get("search-by-all",{subjcode:subjcode,crsecode:crsecode,department:department,professor:professor,title:title,levels:levels,days:days,timestr:timestr,opensection:opensection.toString(),isbasic:isbasic.toString(),basicsearchvalue:basicsearchvalue,termcode:this.#term})}sections(subject,course){return this.get("search-load-group-data",{subjcode:subject.padEnd(4," "),crsecode:course.padEnd(5," "),termcode:this.#term})}async*allCourses(){const courses=await this.courses();for(const course of courses){const groups=await this.sections(course.SUBJ_CODE,course.CRSE_CODE);yield new Course(course,groups)}}schedule(scheduleName="My Schedule",{final:__final="",sectnum:sectnum=""}={}){return this.get("get-class",{schedname:scheduleName,final:__final,sectnum:sectnum,termcode:this.#term})}getSchedule(name){return this.schedule(name).then((sections=>sections.map((section=>new ScheduleSection(section)))))}}class Time{hour;minute;constructor(hour,minute){this.hour=hour;this.minute=minute}toString(){return`${(this.hour+11)%12+1}:${this.minute.toString().padStart(2,"0")} ${this.hour<12?"a":"p"}m`}valueOf(){return this.hour*60+this.minute}}class Period{day;start;end;constructor(day,start,end){this.day=day;this.start=start;this.end=end}intersects(other){return this.day===other.day&&this.start<other.end&&other.start<this.end}displayTime(){return`${this.start}–${this.end}`}static#DAY_NAMES=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];dayName(){return Period.#DAY_NAMES[this.day]}toString(){return`${this.displayTime()} on ${this.dayName()}`}static#MINUTES_PER_DAY=24*60;valueOf(){return this.day*Period.#MINUTES_PER_DAY+this.start.valueOf()}}class BaseGroup{code;location;instructors;groupType;instructionType;start;end;days;raw;constructor(rawGroup){this.code=rawGroup.SECT_CODE;this.location=rawGroup.BLDG_CODE==="TBA"&&rawGroup.ROOM_CODE==="TBA"?null:{building:rawGroup.BLDG_CODE.trim(),room:rawGroup.ROOM_CODE.trim()};this.instructors=rawGroup.PERSON_FULL_NAME===""?[]:rawGroup.PERSON_FULL_NAME.split(":").map((instructor=>{const[name,pid]=instructor.split(";");return{name:name,pid:pid}}));this.groupType=rawGroup.FK_SPM_SPCL_MTG_CD;this.instructionType=rawGroup.FK_CDI_INSTR_TYPE;this.start=new Time(rawGroup.BEGIN_HH_TIME,rawGroup.BEGIN_MM_TIME);this.end=new Time(rawGroup.END_HH_TIME,rawGroup.END_MM_TIME);this.days=rawGroup.DAY_CODE.split("").map((day=>+day));this.raw=rawGroup}isExam(){return this.groupType!=="  "&&this.groupType!=="TBA"}times(){return this.days.map((day=>new Period(day,this.start,this.end)))}}class Group extends BaseGroup{capacity;enrolled;waitlist;stopEnrolment;cancelled;plannable;enrollable;constructor(rawGroup){super(rawGroup);this.capacity=rawGroup.SCTN_CPCTY_QTY===9999?Infinity:rawGroup.SCTN_CPCTY_QTY;this.enrolled=rawGroup.SCTN_ENRLT_QTY;this.waitlist=rawGroup.COUNT_ON_WAITLIST;this.stopEnrolment=rawGroup.STP_ENRLT_FLAG==="Y";this.cancelled=rawGroup.FK_SST_SCTN_STATCD==="CA";this.plannable=rawGroup.FK_SST_SCTN_STATCD==="AC"&&!this.isExam();this.enrollable=this.plannable&&this.enrolled<this.capacity&&!this.stopEnrolment}}class Course{subject;course;title;unit;groups;constructor(rawCourse,rawGroups){this.subject=rawCourse.SUBJ_CODE.trim();this.course=rawCourse.CRSE_CODE.trim();this.title=rawCourse.CRSE_TITLE.trim();this.unit={from:rawCourse.UNIT_FROM,to:rawCourse.UNIT_TO,step:rawCourse.UNIT_INC};this.groups=rawGroups.map((group=>new Group(group)))}}const gradeScaleKey={L:"L",P:"P/NP","P/NP":"P/NP",S:"S/U","S/U":"S/U",H:"H"," ":null};class ScheduleSection extends BaseGroup{course;state;constructor(rawClass){super(rawClass);this.course={subject:rawClass.SUBJ_CODE.trim(),course:rawClass.CRSE_CODE.trim(),title:rawClass.CRSE_TITLE.trim(),unit:rawClass.SECT_CREDIT_HRS,canChangeUnit:rawClass.SECT_CREDIT_HRS_PL==="+",gradeScale:gradeScaleKey[rawClass.GRADE_OPTION],canChangeGradeScale:rawClass.GRADE_OPTN_CD_PLUS==="+"};this.state=rawClass.ENROLL_STATUS==="WT"?{type:"waitlisted",position:+rawClass.WT_POS}:{type:rawClass.ENROLL_STATUS==="EN"?"enrolled":"planned"}}}if(importMeta.main){const getter=new AuthorizedGetter("WI22",Deno.args[0],Deno.args[1],true);const courses=[];for await(const course of getter.allCourses()){courses.push(course)}}const params=new URL(window.location.href).searchParams;const term=params.get("p1");if(!term){alert("I can't know what quarter you're on based on the URL. Have you selected a quarter yet?");throw new Error("Unable to get term from URL.")}const getter=new AuthorizedGetter(term);function useAsyncEffect(callback){T1((()=>{callback()}),[])}function Checkbox({checked:checked,onCheck:onCheck,disabled:disabled,children:children}){return v("p",{children:v("label",{children:[v("input",{type:"checkbox",checked:checked,onChange:onCheck&&(e25=>onCheck(e25.currentTarget.checked)),disabled:disabled})," ",children]})})}const dayNames=["Sundays","Mondays","Tuesdays","Wednesdays","Thursdays","Fridays","Saturdays"];function CourseEntry({course:course,sections:sections}){const[open1,setOpen]=F1(false);return v("div",{class:"st-course-wrapper",children:[v("button",{class:`st-course ${open1?"st-open":""}`,onClick:()=>setOpen((open=>!open)),children:[v("div",{class:"st-course-code",children:[course.subject," ",course.course]}),v("div",{class:"st-course-title",children:course.title})]}),open1&&v("div",{class:"st-sections",children:sections.map((section=>v("div",{class:`st-section ${section.waitlist>0?"st-has-waitlist":""}`,children:[v("div",{class:"st-section-code",children:[section.code,v("div",{class:"st-enrolled",children:section.enrolled<section.capacity?v(U,{children:[v("strong",{children:section.enrolled}),section.capacity===Infinity?"":`/${section.capacity}`," ","enrolled"]}):v(U,{children:[v("strong",{children:section.waitlist})," waitlisted"]})})]}),v("div",{className:"st-info",children:[v("div",{class:"st-time",children:[v("div",{children:[section.start.toString(),"–",section.end.toString()]}),v("div",{children:["on ",section.days.map((day=>dayNames[day])).join(", ")]})]}),v("div",{className:"st-professor",children:section.instructors.length>0?section.instructors.map((instructor=>{const[lastName,firstName]=instructor.name.split(", ");return v(U,{children:[v("div",{children:firstName}),v("div",{children:v("strong",{children:lastName})})]})})):"Staff"})]})]},section.code)))})]})}function CourseList({lowerDivOnly:lowerDivOnly,checkSchedule:checkSchedule,joinableOnly:joinableOnly,tenPercentRule:tenPercentRule}){const[courses1,setCourses]=F1([]);const[loading,setLoading]=F1(false);useAsyncEffect((async()=>{setLoading(true);const courses=[];for await(const course of getter.allCourses()){courses.push(course);setCourses([...courses])}setLoading(false)}));return v("div",{children:[courses1.map((course=>{if(lowerDivOnly){const courseNumber=course.course.match(/\d+/)?.[0];if(courseNumber&&+courseNumber>=100){return null}}const approvedLetters=["0"];if(checkSchedule){const otherSections=course.groups.filter((group=>!group.isExam()&&!group.plannable));const sectionsByLetters={};for(const section1 of otherSections){if(/^[A-Z]$/.test(section1.code[0])){sectionsByLetters[section1.code[0]]??=[];sectionsByLetters[section1.code[0]].push(section1)}else if(section1.code[0]!=="0"){console.log(section1.code,course,section1)}}for(const[letter,sections]of Object.entries(sectionsByLetters)){if(sections.every((section=>!section.times().some((time=>checkSchedule.some((period=>time.intersects(period)))))))){approvedLetters.push(letter)}}}const sections=course.groups.filter((group=>{if(!group.plannable)return false;if(joinableOnly&&!group.enrollable&&!(tenPercentRule&&group.waitlist+1<=group.capacity*.1)){return false}if(checkSchedule){if(!approvedLetters.includes(group.code[0])){return false}const times=group.times();if(checkSchedule.some((period=>times.some((time=>time.intersects(period)))))){return false}}return true}));return sections.length>0?v(CourseEntry,{course:course,sections:sections},course.subject+course.course):null})),loading?v("p",{children:"Loading..."}):null]})}function App(){const[upperDiv,setUpperDiv]=F1(false);const[conflicts,setConflicts]=F1(false);const[full,setFull]=F1(false);const[tenPercent,setTenPercent]=F1(false);const[schedule,setSchedule]=F1();useAsyncEffect((async()=>{const sections=await getter.getSchedule();setSchedule(sections.filter((section=>section.state.type!=="planned")).flatMap((section=>section.times())))}));T1((()=>{const link=document.createElement("link");link.rel="stylesheet";link.href="http://localhost:8080/webreg-scraping/bookmarklet/styles.css";document.head.append(link);return()=>{link.remove()}}),[]);return v("div",{children:[v("fieldset",{children:[v("legend",{children:"Filters"}),v(Checkbox,{checked:upperDiv,onCheck:setUpperDiv,children:"Include upper division courses"}),v(Checkbox,{checked:conflicts,onCheck:setConflicts,children:"Include conflicts with current schedule"}),v(Checkbox,{checked:full,onCheck:setFull,disabled:tenPercent,children:"Include full sections"}),v(Checkbox,{checked:tenPercent,onCheck:setTenPercent,children:"Only include full sections following the 10% waitlist rule"})]}),schedule&&v(CourseList,{lowerDivOnly:!upperDiv,checkSchedule:conflicts?null:schedule,joinableOnly:tenPercent||!full,tenPercentRule:tenPercent})]})}const root=document.createElement("div");document.getElementById("msg-status")?.after(root);re(v(App,{}),root);
